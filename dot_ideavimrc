source ~/.vimrc

set mouse=a
set commentary
set surround
set ideajoin
set multiple-cursors
set highlightedyank
set quickscope

set clipboard+=unnamed

" avoid accidental pagination while in insert mode (keymap woes).
imap <PageUp> <Space>
imap <PageDown> <Space>
map <Leader>\   <Action>(Refactorings.QuickListPopupAction)
map <Leader>e   <Action>(ReSharperGotoNextErrorInSolution)
map <Leader>r   <Action>(ChooseRunConfiguration)
map <Leader>R   <Action>(RenameElement)
map <Leader>t   <Action>(SearchEverywhere)

" Rider specific actions
map <Leader>TC  <Action>(RiderUnitTestRunContextAction)
map <Leader>TD  <Action>(RiderUnitTestDebugContextAction)
map <Leader>TS  <Action>(RiderUnitTestNewSessionAction)
map <Leader>TF  <Action>(RiderUnitTestSessionRerunFailedTestsAction)
map <Leader>TU  <Action>(RiderUnitTestRunContextUntilFailAction)
map <Leader>TT  <Action>(RiderUnitTestRunCurrentSessionAction)
map <Leader>TR  <Action>(RiderUnitTestRunCurrentSessionAction)
map <Leader>TA  <Action>(Rider.UnitTesting.RunSolution)
" nmap <Enter> <Action>(RiderDebuggerApplyEncChagnes)
"
map <Leader>u   <Action>(GotoSuperMethod)
map <Leader>i   <Action>(GotoImplementation)
map <Leader>o   <Action>(ManageRecentProjects)
map <Leader>p   <Action>(GotoAction)
map <Leader>pp  <Action>(TogglePresentationMode)
map <Leader>pf  <Action>(ToggleFullScreen)
map <Leader>D   <Action>(ToggleDistractionFreeMode)

map <Leader>a   <Action>(XDebugger.AttachToProcess)
map <Leader>A   <Action>(Annotate)
map <Leader>s   <Action>(FileStructurePopup)
map <Leader>S   <Action>(ShowSolutionPropertiesAction)
map <Leader>d   <Action>(ChooseDebugConfiguration)
map <Leader>F   <Action>(FindInPath)
map <Leader>G   <Action>(Github.Open.In.Browser)
map <C-'>       <Action>(Run)

map <Leader>b   <Action>(ToggleLineBreakpoint)
map <Leader>B   <Action>(ViewBreakpoints)
nmap <Leader>Gp <Action>(Git.Commit.And.Push.Executor)
nmap <leader>Gc <Action>(Vcs.Show.Local.Changes)
nmap <leader>Gb <Action>(Git.Branches)
nmap <leader>Gf <Action>(Git.Fetch)
map <Leader>n   <Action>(RiderNuGetRestoreForceAction)
map <Leader>l   <Action>(RestoreDefaultLayout)
nmap ,          <Action>(ShowIntentionActions)

nmap <Tab>      <Action>(ShowErrorDescription)
imap <Tab>      <Action>(InsertInlineCompletionAction)
nmap <Leader>qq <Action>(JumpToLastWindow)

map <Leader>I   <Action>(ShowHoverInfo)

nmap ;          <Action>(AceAction)

map <Leader>,   :source ~/.ideavimrc<CR>
map <Leader>.   :e ~/.ideavimrc<CR>
map <C-h>       <Action>(PreviousTab)
map <C-l>       <Action>(NextTab)

map <C-j>       <Action>(ResizeToolWindowDown)
map <C-k>       <Action>(ResizeToolWindowUp)

nmap <Space> <C-D>
nmap <S-Space> <C-U>

map <Leader>wt <Action>(ActivateUnitTestsToolWindow)
map <Leader>wd <Action>(ActivateDebugToolWindow)
map <Leader>ws <Action>(ActivateProjectToolWindow)
map <Leader>wt <Action>(ActivateTerminalToolWindow)
map <Leader>we <Action>(Rider.ProblemsView.ErrorsInSolution)
map <Leader>wi <Action>(NavigateToImmediateWindow)
map <Leader>wr <Action>(ActivateRunToolWindow)
map <Leader>wf <Action>(ActivateStructureToolWindow)
map <Leader>wp <Action>(ActivatedotTraceProfilerToolWindow)
map <Leader>wc <Action>(ShowSolutionPropertiesAction)
map <Leader>wn <Action>(ActivateNuGetToolWindow)
map <Leader>ww <Action>(HideAllWindows)
map <Leader>wq <Action>(HideSideWindows)
map <Leader>wb <Action>(ViewStatusBar)

" extract actions
map <Leader>xi <Action>(ExtractInterface)
map <Leader>xs <Action>(ExtractSuperclass)
map <Leader>xc <Action>(ExtractClass)
map <Leader>xm <Action>(ExtractMethod)

map <Leader>cv <Action>(IntroduceVariable)
map <Leader>ci <Action>(Inline)
map <Leader>cf <Action>(IntroduceField)
map <Leader>cp <Action>(IntroduceParameter)
map <Leader>cc <Action>(IntroduceConstant)

nmap gr <Action>(GotoSuperMethod)
nmap gb <Action>(GotoSuperMethod)
nmap gu <Action>(ShowUsages)

" comment a line, similar to tpope/vim-commentary
nmap gcc <Action>(CommentByLineComment)
vmap gcc <Action>(CommentByLineComment)

" fix actions
nmap <Leader>ff <Action>(ReformatCode)
vmap <Leader>ff <Esc>gvhh:<bs><bs><bs><bs><bs>action VimVisualSwapSelections<cr><Action>(ReformatCode<C)
nmap <Leader>fi <Action>(OptimizeImports)
nmap <Leader>fa <Action>(ShowIntentionActions<CR><)
nmap <Leader>fr <Action>(ChangeTargetFramework)

" always use jetbrains jumplist
nmap <C-o> <Action>(Back)
nmap <C-i> <Action>(Forward)

map gt   <Action>(SearchEverywhere)
map gd   <Action>(GotoDeclaration)
map gf   <Action>(GotoFile)

" https://youtrack.jetbrains.com/issue/VIM-2178/multiple-cursors-defines-incorrect-keys
" Remap multiple-cursors shortcuts to match terryma/vim-multiple-cursors
nmap <C-n> <Plug>NextWholeOccurrence
xmap <C-n> <Plug>NextWholeOccurrence
nmap g<C-n> <Plug>NextOccurrence
xmap g<C-n> <Plug>NextOccurrence
" nmap <C-x> <Plug>SkipOccurrence
" xmap <C-x> <Plug>SkipOccurrence
nmap <C-p> <Plug>RemoveOccurrence
xmap <C-p> <Plug>RemoveOccurrence

" Note that the default <A-n> and g<A-n> shortcuts don't work on Mac due to dead keys.
" <A-n> is used to enter accented text e.g. Ã±
nmap <S-C-n> <Plug>AllWholeOccurrences
xmap <S-C-n> <Plug>AllWholeOccurrences
nmap g<S-C-n> <Plug>AllOccurrences
xmap g<S-C-n> <Plug>AllOccurrences
